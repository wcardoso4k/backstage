"use strict";(self.webpackChunkstorybook=self.webpackChunkstorybook||[]).push([[8957],{"../packages/core-components/src/components/LogViewer/AnsiProcessor.ts":(module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{e:()=>AnsiProcessor});var ansi_regex__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../packages/core-components/node_modules/ansi-regex/index.js"),enterModule;function _nullishCoalesce(lhs,rhsFn){return null!=lhs?lhs:rhsFn()}function _optionalChain(ops){let lastAccessLHS,value=ops[0],i=1;for(;i<ops.length;){const op=ops[i],fn=ops[i+1];if(i+=2,("optionalAccess"===op||"optionalCall"===op)&&null==value)return;"access"===op||"optionalAccess"===op?(lastAccessLHS=value,value=fn(value)):"call"!==op&&"optionalCall"!==op||(value=fn(((...args)=>value.call(lastAccessLHS,...args))),lastAccessLHS=void 0)}return value}module=__webpack_require__.hmd(module),enterModule=__webpack_require__("../node_modules/react-hot-loader/index.js").enterModule,enterModule&&enterModule(module);const ansiRegex=(0,ansi_regex__WEBPACK_IMPORTED_MODULE_0__.Z)(),newlineRegex=/\n\r?/g,codeModifiers=Object.fromEntries(Object.entries({1:m=>({...m,bold:!0}),3:m=>({...m,italic:!0}),4:m=>({...m,underline:!0}),22:({bold:_,...m})=>m,23:({italic:_,...m})=>m,24:({underline:_,...m})=>m,30:m=>({...m,foreground:"black"}),31:m=>({...m,foreground:"red"}),32:m=>({...m,foreground:"green"}),33:m=>({...m,foreground:"yellow"}),34:m=>({...m,foreground:"blue"}),35:m=>({...m,foreground:"magenta"}),36:m=>({...m,foreground:"cyan"}),37:m=>({...m,foreground:"white"}),39:({foreground:_,...m})=>m,90:m=>({...m,foreground:"grey"}),40:m=>({...m,background:"black"}),41:m=>({...m,background:"red"}),42:m=>({...m,background:"green"}),43:m=>({...m,background:"yellow"}),44:m=>({...m,background:"blue"}),45:m=>({...m,background:"magenta"}),46:m=>({...m,background:"cyan"}),47:m=>({...m,background:"white"}),49:({background:_,...m})=>m}).map((([code,modifier])=>[`[${code}m`,modifier])));class AnsiLine{__reactstandin__regenerateByEval(key,code){this[key]=eval(code)}constructor(lineNumber=1,chunks=[]){this.lineNumber=lineNumber,this.chunks=chunks,this.text=chunks.map((c=>c.text)).join("").toLocaleLowerCase("en-US")}lastChunk(){return this.chunks[this.chunks.length-1]}replaceLastChunk(newChunks){newChunks&&(this.chunks.splice(this.chunks.length-1,1,...newChunks),this.text=this.chunks.map((c=>c.text)).join("").toLocaleLowerCase("en-US"))}}class AnsiProcessor{__reactstandin__regenerateByEval(key,code){this[key]=eval(code)}constructor(){AnsiProcessor.prototype.__init.call(this),AnsiProcessor.prototype.__init2.call(this),AnsiProcessor.prototype.__init3.call(this),AnsiProcessor.prototype.__init4.call(this),AnsiProcessor.prototype.__init5.call(this)}__init(){this.text=""}__init2(){this.lines=[]}process(text){if(this.text===text)return this.lines;if(text.startsWith(this.text)){const lastLineIndex=this.lines.length>0?this.lines.length-1:0,lastLine=_nullishCoalesce(this.lines[lastLineIndex],(()=>new AnsiLine)),lastChunk=lastLine.lastChunk(),newLines=this.processLines(_nullishCoalesce(_optionalChain([lastChunk,"optionalAccess",_4=>_4.text]),(()=>""))+text.slice(this.text.length),_optionalChain([lastChunk,"optionalAccess",_5=>_5.modifiers]),_optionalChain([lastLine,"optionalAccess",_6=>_6.lineNumber]));lastLine.replaceLastChunk(_optionalChain([newLines,"access",_7=>_7[0],"optionalAccess",_8=>_8.chunks])),this.lines[lastLineIndex]=lastLine,this.lines.push(...newLines.slice(1))}else this.lines=this.processLines(text);return this.text=text,this.lines}__init3(){this.processLines=(text,modifiers={},startingLineNumber=1)=>{const lines=[];let currentModifiers=modifiers,currentLineNumber=startingLineNumber,prevIndex=0;for(newlineRegex.lastIndex=0;;){const match=newlineRegex.exec(text);if(!match){const chunks=this.processText(text.slice(prevIndex),currentModifiers);return lines.push(new AnsiLine(currentLineNumber,chunks)),lines}const line=text.slice(prevIndex,match.index);prevIndex=match.index+match[0].length;const chunks=this.processText(line,currentModifiers);lines.push(new AnsiLine(currentLineNumber,chunks)),currentModifiers=_nullishCoalesce(chunks[chunks.length-1].modifiers,(()=>currentModifiers)),currentLineNumber+=1}}}__init4(){this.processText=(fullText,modifiers)=>{const chunks=[];let currentModifiers=modifiers,prevIndex=0;for(ansiRegex.lastIndex=0;;){const match=ansiRegex.exec(fullText);if(!match)return chunks.push({text:fullText.slice(prevIndex),modifiers:currentModifiers}),chunks;const text=fullText.slice(prevIndex,match.index);chunks.push({text,modifiers:currentModifiers}),prevIndex=match.index+match[0].length,currentModifiers=this.processCode(match[0],currentModifiers)}}}__init5(){this.processCode=(code,modifiers)=>_nullishCoalesce(_optionalChain([codeModifiers,"access",_9=>_9[code],"optionalCall",_10=>_10(modifiers)]),(()=>modifiers))}}var reactHotLoader,leaveModule;reactHotLoader=__webpack_require__("../node_modules/react-hot-loader/index.js").default,leaveModule=__webpack_require__("../node_modules/react-hot-loader/index.js").leaveModule,reactHotLoader&&(reactHotLoader.register(ansiRegex,"ansiRegex","/home/runner/work/backstage/backstage/packages/core-components/src/components/LogViewer/AnsiProcessor.ts"),reactHotLoader.register(newlineRegex,"newlineRegex","/home/runner/work/backstage/backstage/packages/core-components/src/components/LogViewer/AnsiProcessor.ts"),reactHotLoader.register(codeModifiers,"codeModifiers","/home/runner/work/backstage/backstage/packages/core-components/src/components/LogViewer/AnsiProcessor.ts"),reactHotLoader.register(AnsiLine,"AnsiLine","/home/runner/work/backstage/backstage/packages/core-components/src/components/LogViewer/AnsiProcessor.ts"),reactHotLoader.register(AnsiProcessor,"AnsiProcessor","/home/runner/work/backstage/backstage/packages/core-components/src/components/LogViewer/AnsiProcessor.ts"),leaveModule(module))},"../packages/core-components/src/components/LogViewer/LogLine.tsx":(module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{Z:()=>LogLine});var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/index.js"),lodash_startCase__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../node_modules/lodash/startCase.js"),lodash_startCase__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(lodash_startCase__WEBPACK_IMPORTED_MODULE_1__),classnames__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("../node_modules/classnames/index.js"),classnames__WEBPACK_IMPORTED_MODULE_2___default=__webpack_require__.n(classnames__WEBPACK_IMPORTED_MODULE_2__);module=__webpack_require__.hmd(module);var enterModule,reactHotLoader,leaveModule;function getModifierClasses(classes,modifiers){const classNames=new Array;if(modifiers.bold&&classNames.push(classes.modifierBold),modifiers.italic&&classNames.push(classes.modifierItalic),modifiers.underline&&classNames.push(classes.modifierUnderline),modifiers.foreground){const key=`modifierForeground${lodash_startCase__WEBPACK_IMPORTED_MODULE_1___default()(modifiers.foreground)}`;classNames.push(classes[key])}if(modifiers.background){const key=`modifierBackground${lodash_startCase__WEBPACK_IMPORTED_MODULE_1___default()(modifiers.background)}`;classNames.push(classes[key])}return classNames.length>0?classNames.join(" "):void 0}function findSearchResults(text,searchText){if(!searchText||!text.includes(searchText))return;const searchResults=new Array;let offset=0;for(;;){const start=text.indexOf(searchText,offset);if(-1===start)break;const end=start+searchText.length;searchResults.push({start,end}),offset=end}return searchResults}function calculateHighlightedChunks(line,searchText){const results=findSearchResults(line.text,searchText);if(!results)return line.chunks;const chunks=new Array;let lineOffset=0,resultIndex=0,result=results[resultIndex];for(const chunk of line.chunks){const{text,modifiers}=chunk;if(!result||lineOffset+text.length<result.start){chunks.push(chunk),lineOffset+=text.length;continue}let localOffset=0;for(;result;){const localStart=Math.max(result.start-lineOffset,0);if(localStart>text.length)break;const localEnd=Math.min(result.end-lineOffset,text.length);localStart>localOffset&&chunks.push({text:text.slice(localOffset,localStart),modifiers});localEnd>localStart&&chunks.push({modifiers,highlight:resultIndex,text:text.slice(localStart,localEnd)}),localOffset=localEnd;if(!(result.end-lineOffset===localEnd))break;resultIndex+=1,result=results[resultIndex]}localOffset<text.length&&chunks.push({text:text.slice(localOffset),modifiers}),lineOffset+=text.length}return chunks}function LogLine({line,classes,searchText,highlightResultIndex}){const chunks=(0,react__WEBPACK_IMPORTED_MODULE_0__.useMemo)((()=>calculateHighlightedChunks(line,searchText)),[line,searchText]),elements=(0,react__WEBPACK_IMPORTED_MODULE_0__.useMemo)((()=>chunks.map((({text,modifiers,highlight},index)=>react__WEBPACK_IMPORTED_MODULE_0__.createElement("span",{key:index,className:classnames__WEBPACK_IMPORTED_MODULE_2___default()(getModifierClasses(classes,modifiers),void 0!==highlight&&(highlight===highlightResultIndex?classes.textSelectedHighlight:classes.textHighlight)),__self:this,__source:{fileName:"/home/runner/work/backstage/backstage/packages/core-components/src/components/LogViewer/LogLine.tsx",lineNumber:161}},text)))),[chunks,highlightResultIndex,classes]);return react__WEBPACK_IMPORTED_MODULE_0__.createElement(react__WEBPACK_IMPORTED_MODULE_0__.Fragment,null,elements)}(enterModule=__webpack_require__("../node_modules/react-hot-loader/index.js").enterModule)&&enterModule(module),reactHotLoader=__webpack_require__("../node_modules/react-hot-loader/index.js").default,leaveModule=__webpack_require__("../node_modules/react-hot-loader/index.js").leaveModule,reactHotLoader&&(reactHotLoader.register(getModifierClasses,"getModifierClasses","/home/runner/work/backstage/backstage/packages/core-components/src/components/LogViewer/LogLine.tsx"),reactHotLoader.register(findSearchResults,"findSearchResults","/home/runner/work/backstage/backstage/packages/core-components/src/components/LogViewer/LogLine.tsx"),reactHotLoader.register(calculateHighlightedChunks,"calculateHighlightedChunks","/home/runner/work/backstage/backstage/packages/core-components/src/components/LogViewer/LogLine.tsx"),reactHotLoader.register(LogLine,"LogLine","/home/runner/work/backstage/backstage/packages/core-components/src/components/LogViewer/LogLine.tsx"),leaveModule(module));try{LogLine.displayName="LogLine",LogLine.__docgenInfo={description:"",displayName:"LogLine",props:{line:{defaultValue:null,description:"",name:"line",required:!0,type:{name:"AnsiLine"}},classes:{defaultValue:null,description:"",name:"classes",required:!0,type:{name:'ClassNameMap<"root" | "header" | "line" | "log" | "lineSelected" | "lineCopyButton" | "lineNumber" | "textHighlight" | "textSelectedHighlight" | "modifierBold" | "modifierItalic" | "modifierUnderline" | ... 17 more ... | "modifierBackgroundGrey">'}},searchText:{defaultValue:null,description:"",name:"searchText",required:!0,type:{name:"string"}},highlightResultIndex:{defaultValue:null,description:"",name:"highlightResultIndex",required:!1,type:{name:"number"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../packages/core-components/src/components/LogViewer/LogLine.tsx#LogLine"]={docgenInfo:LogLine.__docgenInfo,name:"LogLine",path:"../packages/core-components/src/components/LogViewer/LogLine.tsx#LogLine"})}catch(__react_docgen_typescript_loader_error){}},"../packages/core-components/src/components/LogViewer/LogViewerControls.tsx":(module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{y:()=>LogViewerControls});var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/index.js"),_material_ui_core_IconButton__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../node_modules/@material-ui/core/esm/IconButton/IconButton.js"),_material_ui_core_TextField__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("../node_modules/@material-ui/core/esm/TextField/TextField.js"),_material_ui_core_Typography__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("../node_modules/@material-ui/core/esm/Typography/Typography.js"),_material_ui_icons_ChevronLeft__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("../node_modules/@material-ui/icons/ChevronLeft.js"),_material_ui_icons_ChevronRight__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("../node_modules/@material-ui/icons/ChevronRight.js"),_material_ui_icons_FilterList__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("../node_modules/@material-ui/icons/FilterList.js");module=__webpack_require__.hmd(module);const _jsxFileName="/home/runner/work/backstage/backstage/packages/core-components/src/components/LogViewer/LogViewerControls.tsx";var enterModule,reactHotLoader,leaveModule;function LogViewerControls(props){const{resultCount,resultIndexStep,toggleShouldFilter}=props,resultIndex=function _nullishCoalesce(lhs,rhsFn){return null!=lhs?lhs:rhsFn()}(props.resultIndex,(()=>0));return react__WEBPACK_IMPORTED_MODULE_0__.createElement(react__WEBPACK_IMPORTED_MODULE_0__.Fragment,null,void 0!==resultCount&&react__WEBPACK_IMPORTED_MODULE_0__.createElement(react__WEBPACK_IMPORTED_MODULE_0__.Fragment,null,react__WEBPACK_IMPORTED_MODULE_0__.createElement(_material_ui_core_IconButton__WEBPACK_IMPORTED_MODULE_1__.Z,{size:"small",onClick:()=>resultIndexStep(!0),__self:this,__source:{fileName:_jsxFileName,lineNumber:46}},react__WEBPACK_IMPORTED_MODULE_0__.createElement(_material_ui_icons_ChevronLeft__WEBPACK_IMPORTED_MODULE_2__.Z,{__self:this,__source:{fileName:_jsxFileName,lineNumber:47}})),react__WEBPACK_IMPORTED_MODULE_0__.createElement(_material_ui_core_Typography__WEBPACK_IMPORTED_MODULE_3__.Z,{__self:this,__source:{fileName:_jsxFileName,lineNumber:49}},Math.min(resultIndex+1,resultCount),"/",resultCount),react__WEBPACK_IMPORTED_MODULE_0__.createElement(_material_ui_core_IconButton__WEBPACK_IMPORTED_MODULE_1__.Z,{size:"small",onClick:()=>resultIndexStep(),__self:this,__source:{fileName:_jsxFileName,lineNumber:52}},react__WEBPACK_IMPORTED_MODULE_0__.createElement(_material_ui_icons_ChevronRight__WEBPACK_IMPORTED_MODULE_4__.Z,{__self:this,__source:{fileName:_jsxFileName,lineNumber:53}}))),react__WEBPACK_IMPORTED_MODULE_0__.createElement(_material_ui_core_TextField__WEBPACK_IMPORTED_MODULE_5__.Z,{size:"small",variant:"standard",placeholder:"Search",value:props.searchInput,onKeyPress:event=>{"Enter"===event.key&&(event.metaKey||event.ctrlKey||event.altKey?toggleShouldFilter():resultIndexStep(event.shiftKey))},onChange:e=>props.setSearchInput(e.target.value),__self:this,__source:{fileName:_jsxFileName,lineNumber:57}}),react__WEBPACK_IMPORTED_MODULE_0__.createElement(_material_ui_core_IconButton__WEBPACK_IMPORTED_MODULE_1__.Z,{size:"small",onClick:toggleShouldFilter,__self:this,__source:{fileName:_jsxFileName,lineNumber:65}},props.shouldFilter?react__WEBPACK_IMPORTED_MODULE_0__.createElement(_material_ui_icons_FilterList__WEBPACK_IMPORTED_MODULE_6__.Z,{color:"primary",__self:this,__source:{fileName:_jsxFileName,lineNumber:67}}):react__WEBPACK_IMPORTED_MODULE_0__.createElement(_material_ui_icons_FilterList__WEBPACK_IMPORTED_MODULE_6__.Z,{color:"disabled",__self:this,__source:{fileName:_jsxFileName,lineNumber:69}})))}(enterModule=__webpack_require__("../node_modules/react-hot-loader/index.js").enterModule)&&enterModule(module),reactHotLoader=__webpack_require__("../node_modules/react-hot-loader/index.js").default,leaveModule=__webpack_require__("../node_modules/react-hot-loader/index.js").leaveModule,reactHotLoader&&(reactHotLoader.register(LogViewerControls,"LogViewerControls","/home/runner/work/backstage/backstage/packages/core-components/src/components/LogViewer/LogViewerControls.tsx"),leaveModule(module));try{LogViewerControls.displayName="LogViewerControls",LogViewerControls.__docgenInfo={description:"",displayName:"LogViewerControls",props:{lines:{defaultValue:null,description:"",name:"lines",required:!0,type:{name:"AnsiLine[]"}},searchText:{defaultValue:null,description:"",name:"searchText",required:!0,type:{name:"string"}},searchInput:{defaultValue:null,description:"",name:"searchInput",required:!0,type:{name:"string"}},setSearchInput:{defaultValue:null,description:"",name:"setSearchInput",required:!0,type:{name:"(searchInput: string) => void"}},shouldFilter:{defaultValue:null,description:"",name:"shouldFilter",required:!0,type:{name:"boolean"}},toggleShouldFilter:{defaultValue:null,description:"",name:"toggleShouldFilter",required:!0,type:{name:"() => void"}},resultCount:{defaultValue:null,description:"",name:"resultCount",required:!0,type:{name:"number"}},resultIndex:{defaultValue:null,description:"",name:"resultIndex",required:!0,type:{name:"number"}},resultIndexStep:{defaultValue:null,description:"",name:"resultIndexStep",required:!0,type:{name:"(decrement?: boolean) => void"}},resultLine:{defaultValue:null,description:"",name:"resultLine",required:!0,type:{name:"number"}},resultLineIndex:{defaultValue:null,description:"",name:"resultLineIndex",required:!0,type:{name:"number"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../packages/core-components/src/components/LogViewer/LogViewerControls.tsx#LogViewerControls"]={docgenInfo:LogViewerControls.__docgenInfo,name:"LogViewerControls",path:"../packages/core-components/src/components/LogViewer/LogViewerControls.tsx#LogViewerControls"})}catch(__react_docgen_typescript_loader_error){}},"../packages/core-components/src/components/LogViewer/RealLogViewer.tsx":(module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{RealLogViewer:()=>RealLogViewer});var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/index.js"),react_router_dom__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__("../node_modules/react-router/index.js"),_material_ui_core_IconButton__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__("../node_modules/@material-ui/core/esm/IconButton/IconButton.js"),_material_ui_icons_FileCopy__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__("../node_modules/@material-ui/icons/FileCopy.js"),react_virtualized_auto_sizer__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../node_modules/react-virtualized-auto-sizer/dist/index.esm.js"),react_window__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__("../node_modules/react-window/dist/index.esm.js"),_AnsiProcessor__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("../packages/core-components/src/components/LogViewer/AnsiProcessor.ts"),_styles__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("../packages/core-components/src/components/LogViewer/styles.ts"),classnames__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("../node_modules/classnames/index.js"),classnames__WEBPACK_IMPORTED_MODULE_4___default=__webpack_require__.n(classnames__WEBPACK_IMPORTED_MODULE_4__),_LogLine__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("../packages/core-components/src/components/LogViewer/LogLine.tsx"),_LogViewerControls__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("../packages/core-components/src/components/LogViewer/LogViewerControls.tsx"),_useLogViewerSearch__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("../packages/core-components/src/components/LogViewer/useLogViewerSearch.tsx"),_useLogViewerSelection__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("../packages/core-components/src/components/LogViewer/useLogViewerSelection.tsx");module=__webpack_require__.hmd(module);const _jsxFileName="/home/runner/work/backstage/backstage/packages/core-components/src/components/LogViewer/RealLogViewer.tsx";var enterModule,reactHotLoader,leaveModule;function RealLogViewer(props){const classes=(0,_styles__WEBPACK_IMPORTED_MODULE_3__.y)({classes:props.classes}),listRef=(0,react__WEBPACK_IMPORTED_MODULE_0__.useRef)(null),lines=(0,react__WEBPACK_IMPORTED_MODULE_0__.useMemo)((()=>new _AnsiProcessor__WEBPACK_IMPORTED_MODULE_2__.e),[]).process(props.text),search=(0,_useLogViewerSearch__WEBPACK_IMPORTED_MODULE_7__.G)(lines),selection=(0,_useLogViewerSelection__WEBPACK_IMPORTED_MODULE_8__.l)(lines),location=(0,react_router_dom__WEBPACK_IMPORTED_MODULE_9__.TH)();(0,react__WEBPACK_IMPORTED_MODULE_0__.useEffect)((()=>{void 0!==search.resultLine&&listRef.current&&listRef.current.scrollToItem(search.resultLine-1,"center")}),[search.resultLine]),(0,react__WEBPACK_IMPORTED_MODULE_0__.useEffect)((()=>{if(location.hash){const line=parseInt(location.hash.replace(/\D/g,""),10);selection.setSelection(line,!1)}}),[]);const handleSelectLine=(line,event)=>{selection.setSelection(line,event.shiftKey)};return react__WEBPACK_IMPORTED_MODULE_0__.createElement(react_virtualized_auto_sizer__WEBPACK_IMPORTED_MODULE_1__.Z,{__self:this,__source:{fileName:_jsxFileName,lineNumber:70}},(({height,width})=>react__WEBPACK_IMPORTED_MODULE_0__.createElement("div",{style:{width,height},className:classes.root,__self:this,__source:{fileName:_jsxFileName,lineNumber:72}},react__WEBPACK_IMPORTED_MODULE_0__.createElement("div",{className:classes.header,__self:this,__source:{fileName:_jsxFileName,lineNumber:73}},react__WEBPACK_IMPORTED_MODULE_0__.createElement(_LogViewerControls__WEBPACK_IMPORTED_MODULE_6__.y,{...search,__self:this,__source:{fileName:_jsxFileName,lineNumber:74}})),react__WEBPACK_IMPORTED_MODULE_0__.createElement(react_window__WEBPACK_IMPORTED_MODULE_10__.t7,{ref:listRef,className:classes.log,height:height-_styles__WEBPACK_IMPORTED_MODULE_3__.w,width,itemData:search.lines,itemSize:20,itemCount:search.lines.length,__self:this,__source:{fileName:_jsxFileName,lineNumber:76}},(({index,style,data})=>{const line=data[index],{lineNumber}=line;return react__WEBPACK_IMPORTED_MODULE_0__.createElement("div",{style:{...style},className:classnames__WEBPACK_IMPORTED_MODULE_4___default()(classes.line,{[classes.lineSelected]:selection.isSelected(lineNumber)}),__self:this,__source:{fileName:_jsxFileName,lineNumber:89}},selection.shouldShowButton(lineNumber)&&react__WEBPACK_IMPORTED_MODULE_0__.createElement(_material_ui_core_IconButton__WEBPACK_IMPORTED_MODULE_11__.Z,{"data-testid":"copy-button",size:"small",className:classes.lineCopyButton,onClick:()=>selection.copySelection(),__self:this,__source:{fileName:_jsxFileName,lineNumber:96}},react__WEBPACK_IMPORTED_MODULE_0__.createElement(_material_ui_icons_FileCopy__WEBPACK_IMPORTED_MODULE_12__.Z,{fontSize:"inherit",__self:this,__source:{fileName:_jsxFileName,lineNumber:102}})),react__WEBPACK_IMPORTED_MODULE_0__.createElement("a",{role:"row",target:"_self",href:`#line-${lineNumber}`,className:classes.lineNumber,onClick:event=>handleSelectLine(lineNumber,event),onKeyPress:event=>handleSelectLine(lineNumber,event),__self:this,__source:{fileName:_jsxFileName,lineNumber:105}},lineNumber),react__WEBPACK_IMPORTED_MODULE_0__.createElement(_LogLine__WEBPACK_IMPORTED_MODULE_5__.Z,{line,classes,searchText:search.searchText,highlightResultIndex:search.resultLine===lineNumber?search.resultLineIndex:void 0,__self:this,__source:{fileName:_jsxFileName,lineNumber:115}}))})))))}(enterModule=__webpack_require__("../node_modules/react-hot-loader/index.js").enterModule)&&enterModule(module),reactHotLoader=__webpack_require__("../node_modules/react-hot-loader/index.js").default,leaveModule=__webpack_require__("../node_modules/react-hot-loader/index.js").leaveModule,reactHotLoader&&(reactHotLoader.register(RealLogViewer,"RealLogViewer","/home/runner/work/backstage/backstage/packages/core-components/src/components/LogViewer/RealLogViewer.tsx"),leaveModule(module));try{RealLogViewer.displayName="RealLogViewer",RealLogViewer.__docgenInfo={description:"",displayName:"RealLogViewer",props:{text:{defaultValue:null,description:"",name:"text",required:!0,type:{name:"string"}},classes:{defaultValue:null,description:"",name:"classes",required:!1,type:{name:"{ root?: string; }"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../packages/core-components/src/components/LogViewer/RealLogViewer.tsx#RealLogViewer"]={docgenInfo:RealLogViewer.__docgenInfo,name:"RealLogViewer",path:"../packages/core-components/src/components/LogViewer/RealLogViewer.tsx#RealLogViewer"})}catch(__react_docgen_typescript_loader_error){}},"../packages/core-components/src/components/LogViewer/styles.ts":(module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{w:()=>HEADER_SIZE,y:()=>useStyles});var enterModule,_material_ui_core_styles__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../node_modules/@material-ui/core/esm/styles/makeStyles.js"),_material_ui_core_styles__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../node_modules/@material-ui/core/esm/styles/colorManipulator.js"),_material_ui_core_colors__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("../node_modules/@material-ui/core/esm/colors/common.js"),_material_ui_core_colors__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("../node_modules/@material-ui/core/esm/colors/red.js"),_material_ui_core_colors__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("../node_modules/@material-ui/core/esm/colors/green.js"),_material_ui_core_colors__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("../node_modules/@material-ui/core/esm/colors/yellow.js"),_material_ui_core_colors__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("../node_modules/@material-ui/core/esm/colors/blue.js"),_material_ui_core_colors__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("../node_modules/@material-ui/core/esm/colors/purple.js"),_material_ui_core_colors__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("../node_modules/@material-ui/core/esm/colors/cyan.js"),_material_ui_core_colors__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__("../node_modules/@material-ui/core/esm/colors/grey.js");module=__webpack_require__.hmd(module),(enterModule=__webpack_require__("../node_modules/react-hot-loader/index.js").enterModule)&&enterModule(module);const HEADER_SIZE=40,useStyles=(0,_material_ui_core_styles__WEBPACK_IMPORTED_MODULE_0__.Z)((theme=>({root:{background:theme.palette.background.paper},header:{height:HEADER_SIZE,display:"flex",alignItems:"center",justifyContent:"flex-end"},log:{fontFamily:'"Monaco", monospace',fontSize:theme.typography.pxToRem(12)},line:{position:"relative",whiteSpace:"pre","&:hover":{background:theme.palette.action.hover}},lineSelected:{background:theme.palette.action.selected,"&:hover":{background:theme.palette.action.selected}},lineCopyButton:{position:"absolute",paddingTop:0,paddingBottom:0},lineNumber:{display:"inline-block",textAlign:"end",width:60,marginRight:theme.spacing(1),cursor:"pointer"},textHighlight:{background:(0,_material_ui_core_styles__WEBPACK_IMPORTED_MODULE_1__.Fq)(theme.palette.info.main,.15)},textSelectedHighlight:{background:(0,_material_ui_core_styles__WEBPACK_IMPORTED_MODULE_1__.Fq)(theme.palette.info.main,.4)},modifierBold:{fontWeight:theme.typography.fontWeightBold},modifierItalic:{fontStyle:"italic"},modifierUnderline:{textDecoration:"underline"},modifierForegroundBlack:{color:_material_ui_core_colors__WEBPACK_IMPORTED_MODULE_2__.Z.black},modifierForegroundRed:{color:_material_ui_core_colors__WEBPACK_IMPORTED_MODULE_3__.Z[500]},modifierForegroundGreen:{color:_material_ui_core_colors__WEBPACK_IMPORTED_MODULE_4__.Z[500]},modifierForegroundYellow:{color:_material_ui_core_colors__WEBPACK_IMPORTED_MODULE_5__.Z[500]},modifierForegroundBlue:{color:_material_ui_core_colors__WEBPACK_IMPORTED_MODULE_6__.Z[500]},modifierForegroundMagenta:{color:_material_ui_core_colors__WEBPACK_IMPORTED_MODULE_7__.Z[500]},modifierForegroundCyan:{color:_material_ui_core_colors__WEBPACK_IMPORTED_MODULE_8__.Z[500]},modifierForegroundWhite:{color:_material_ui_core_colors__WEBPACK_IMPORTED_MODULE_2__.Z.white},modifierForegroundGrey:{color:_material_ui_core_colors__WEBPACK_IMPORTED_MODULE_9__.Z[500]},modifierBackgroundBlack:{background:_material_ui_core_colors__WEBPACK_IMPORTED_MODULE_2__.Z.black},modifierBackgroundRed:{background:_material_ui_core_colors__WEBPACK_IMPORTED_MODULE_3__.Z[500]},modifierBackgroundGreen:{background:_material_ui_core_colors__WEBPACK_IMPORTED_MODULE_4__.Z[500]},modifierBackgroundYellow:{background:_material_ui_core_colors__WEBPACK_IMPORTED_MODULE_5__.Z[500]},modifierBackgroundBlue:{background:_material_ui_core_colors__WEBPACK_IMPORTED_MODULE_6__.Z[500]},modifierBackgroundMagenta:{background:_material_ui_core_colors__WEBPACK_IMPORTED_MODULE_7__.Z[500]},modifierBackgroundCyan:{background:_material_ui_core_colors__WEBPACK_IMPORTED_MODULE_8__.Z[500]},modifierBackgroundWhite:{background:_material_ui_core_colors__WEBPACK_IMPORTED_MODULE_2__.Z.white},modifierBackgroundGrey:{background:_material_ui_core_colors__WEBPACK_IMPORTED_MODULE_9__.Z[500]}})),{name:"BackstageLogViewer"});var reactHotLoader,leaveModule;reactHotLoader=__webpack_require__("../node_modules/react-hot-loader/index.js").default,leaveModule=__webpack_require__("../node_modules/react-hot-loader/index.js").leaveModule,reactHotLoader&&(reactHotLoader.register(HEADER_SIZE,"HEADER_SIZE","/home/runner/work/backstage/backstage/packages/core-components/src/components/LogViewer/styles.ts"),reactHotLoader.register(useStyles,"useStyles","/home/runner/work/backstage/backstage/packages/core-components/src/components/LogViewer/styles.ts"),leaveModule(module))},"../packages/core-components/src/components/LogViewer/useLogViewerSearch.tsx":(module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{G:()=>useLogViewerSearch});var enterModule,reactHotLoader,leaveModule,react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/index.js"),_react_hookz_web__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../node_modules/@react-hookz/web/esm/useToggle/useToggle.js");function _optionalChain(ops){let lastAccessLHS,value=ops[0],i=1;for(;i<ops.length;){const op=ops[i],fn=ops[i+1];if(i+=2,("optionalAccess"===op||"optionalCall"===op)&&null==value)return;"access"===op||"optionalAccess"===op?(lastAccessLHS=value,value=fn(value)):"call"!==op&&"optionalCall"!==op||(value=fn(((...args)=>value.call(lastAccessLHS,...args))),lastAccessLHS=void 0)}return value}function applySearchFilter(lines,searchText){if(!searchText)return{lines};const matchingLines=[],searchResults=[];for(const line of lines)if(line.text.includes(searchText)){matchingLines.push(line);let offset=0,lineResultIndex=0;for(;;){const start=line.text.indexOf(searchText,offset);if(-1===start)break;searchResults.push({lineNumber:line.lineNumber,lineIndex:lineResultIndex++}),offset=start+searchText.length}}return{lines:matchingLines,results:searchResults}}function useLogViewerSearch(lines){const[searchInput,setSearchInput]=(0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(""),searchText=searchInput.toLocaleLowerCase("en-US"),[resultIndex,setResultIndex]=(0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(0),[shouldFilter,toggleShouldFilter]=(0,_react_hookz_web__WEBPACK_IMPORTED_MODULE_1__.O)(!1),filter=(0,react__WEBPACK_IMPORTED_MODULE_0__.useMemo)((()=>applySearchFilter(lines,searchText)),[lines,searchText]),searchResult=filter.results?filter.results[Math.min(resultIndex,filter.results.length-1)]:void 0,resultCount=_optionalChain([filter,"access",_=>_.results,"optionalAccess",_2=>_2.length]);return{lines:shouldFilter?filter.lines:lines,searchText,searchInput,setSearchInput,shouldFilter,toggleShouldFilter,resultCount,resultIndex,resultIndexStep:decrement=>{if(decrement){if(void 0!==resultCount){const next=Math.min(resultIndex-1,resultCount-2);setResultIndex(next<0?resultCount-1:next)}}else if(void 0!==resultCount){const next=resultIndex+1;setResultIndex(next>=resultCount?0:next)}},resultLine:_optionalChain([searchResult,"optionalAccess",_3=>_3.lineNumber]),resultLineIndex:_optionalChain([searchResult,"optionalAccess",_4=>_4.lineIndex])}}module=__webpack_require__.hmd(module),(enterModule=__webpack_require__("../node_modules/react-hot-loader/index.js").enterModule)&&enterModule(module),reactHotLoader=__webpack_require__("../node_modules/react-hot-loader/index.js").default,leaveModule=__webpack_require__("../node_modules/react-hot-loader/index.js").leaveModule,reactHotLoader&&(reactHotLoader.register(applySearchFilter,"applySearchFilter","/home/runner/work/backstage/backstage/packages/core-components/src/components/LogViewer/useLogViewerSearch.tsx"),reactHotLoader.register(useLogViewerSearch,"useLogViewerSearch","/home/runner/work/backstage/backstage/packages/core-components/src/components/LogViewer/useLogViewerSearch.tsx"),leaveModule(module));try{useLogViewerSearch.displayName="useLogViewerSearch",useLogViewerSearch.__docgenInfo={description:"",displayName:"useLogViewerSearch",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../packages/core-components/src/components/LogViewer/useLogViewerSearch.tsx#useLogViewerSearch"]={docgenInfo:useLogViewerSearch.__docgenInfo,name:"useLogViewerSearch",path:"../packages/core-components/src/components/LogViewer/useLogViewerSearch.tsx#useLogViewerSearch"})}catch(__react_docgen_typescript_loader_error){}},"../packages/core-components/src/components/LogViewer/useLogViewerSelection.tsx":(module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{l:()=>useLogViewerSelection});var enterModule,reactHotLoader,leaveModule,_backstage_core_plugin_api__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../packages/core-plugin-api/src/index.ts"),react__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/react/index.js"),react_use_lib_useCopyToClipboard__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("../node_modules/react-use/lib/useCopyToClipboard.js");function _optionalChain(ops){let lastAccessLHS,value=ops[0],i=1;for(;i<ops.length;){const op=ops[i],fn=ops[i+1];if(i+=2,("optionalAccess"===op||"optionalCall"===op)&&null==value)return;"access"===op||"optionalAccess"===op?(lastAccessLHS=value,value=fn(value)):"call"!==op&&"optionalCall"!==op||(value=fn(((...args)=>value.call(lastAccessLHS,...args))),lastAccessLHS=void 0)}return value}function useLogViewerSelection(lines){const errorApi=(0,_backstage_core_plugin_api__WEBPACK_IMPORTED_MODULE_0__.useApi)(_backstage_core_plugin_api__WEBPACK_IMPORTED_MODULE_0__.errorApiRef),[sel,setSelection]=(0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(),start=sel?Math.min(sel.start,sel.end):void 0,end=sel?Math.max(sel.start,sel.end):void 0,[{error},copyToClipboard]=(0,react_use_lib_useCopyToClipboard__WEBPACK_IMPORTED_MODULE_2__.Z)();return(0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)((()=>{error&&errorApi.post(error)}),[error,errorApi]),{shouldShowButton:line=>start===line||end===line,isSelected:line=>!!sel&&(start<=line&&line<=end),setSelection(line,add){setSelection(add?s=>s?{start:s.start,end:line}:{start:line,end:line}:s=>_optionalChain([s,"optionalAccess",_=>_.start])===line&&_optionalChain([s,"optionalAccess",_2=>_2.end])===line?void 0:{start:line,end:line})},copySelection(){if(sel){const copyText=lines.slice(Math.min(sel.start,sel.end)-1,Math.max(sel.start,sel.end)).map((l=>l.chunks.map((c=>c.text)).join(""))).join("\n");copyToClipboard(copyText),setSelection(void 0)}}}}module=__webpack_require__.hmd(module),(enterModule=__webpack_require__("../node_modules/react-hot-loader/index.js").enterModule)&&enterModule(module),reactHotLoader=__webpack_require__("../node_modules/react-hot-loader/index.js").default,leaveModule=__webpack_require__("../node_modules/react-hot-loader/index.js").leaveModule,reactHotLoader&&(reactHotLoader.register(useLogViewerSelection,"useLogViewerSelection","/home/runner/work/backstage/backstage/packages/core-components/src/components/LogViewer/useLogViewerSelection.tsx"),leaveModule(module));try{useLogViewerSelection.displayName="useLogViewerSelection",useLogViewerSelection.__docgenInfo={description:"",displayName:"useLogViewerSelection",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../packages/core-components/src/components/LogViewer/useLogViewerSelection.tsx#useLogViewerSelection"]={docgenInfo:useLogViewerSelection.__docgenInfo,name:"useLogViewerSelection",path:"../packages/core-components/src/components/LogViewer/useLogViewerSelection.tsx#useLogViewerSelection"})}catch(__react_docgen_typescript_loader_error){}}}]);